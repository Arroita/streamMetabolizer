% Generated by roxygen2 (4.1.1): do not edit by hand
% Please edit documentation in R/calc_DO_mod_with_error.R
\name{calc_DO_mod_with_error}
\alias{calc_DO_mod_with_error}
\title{Simulates DO with error}
\usage{
calc_DO_mod_with_error(GPP.daily, ER.daily, K600.daily, DO.sat, depth,
  temp.water, frac.GPP, frac.ER, frac.D, DO.mod.1, n, obs.err.sd, obs.err.phi,
  proc.err.sd, proc.err.phi)
}
\arguments{
\item{GPP.daily}{One GPP rate per day (mg O2 / L / d)}

\item{ER.daily}{One ER rate per day (mg O2 / L / d), always non-positive.}

\item{K600.daily}{One K600 per day (1 / d)}

\item{DO.sat}{dissolved oxygen concentrations if the water were at
equilibrium saturation \eqn{mg O[2] L^{-1}}{mg O2 / L}. Calculate using
\link{calc_DO_at_sat}}

\item{depth}{stream depth, \eqn{m}{m}.}

\item{temp.water}{stream temperature in degC}

\item{frac.GPP}{the fraction of daily GPP to apply to each timestep}

\item{frac.ER}{the fraction of daily ER to apply to each timestep}

\item{frac.D}{the fraction of daily D to apply to each timestep}

\item{DO.mod.1}{the first DO.obs value, to which the first DO.mod value will
be set}

\item{n}{number of DO.mod values to produce}

\item{obs.err.sd}{The sd of observation error, or 0 for no observation error.
Observation errors are those applied to DO.mod after generating the full
time series of modeled values.}

\item{obs.err.phi}{The autocorrelation coefficient of the observation errors,
or 0 for uncorrelated errors.}

\item{proc.err.sd}{The sd of process error, or 0 for no process error.
Process errors are applied at each time step, and therefore propagate into
the next timestep.}

\item{proc.err.phi}{The autocorrelation coefficient of the process errors, or
0 for uncorrelated errors.}
}
\description{
Accepts GPP, ER, etc. and returns DO.mod with error added (observation and/or
process error, with or without autocorrelation)
}
\examples{
fr <- rep(1/100,100) # shorthand for readability of next lines
preds <- data.frame(
 t=1:100,
 no_err = calc_DO_mod_with_error(
  10, -13, 2.5, 14, 1, rep(12,100), fr, fr, fr, 11, 100, 0, 0, 0, 0),
 obs_err = calc_DO_mod_with_error(
  10, -13, 2.5, 14, 1, rep(12,100), fr, fr, fr, 11, 100, 0.1, 0, 0, 0),
 ac_obs_err = calc_DO_mod_with_error(
  10, -13, 2.5, 14, 1, rep(12,100), fr, fr, fr, 11, 100, 0.1, 0.6, 0, 0),
 proc_err = calc_DO_mod_with_error(
  10, -13, 2.5, 14, 1, rep(12,100), fr, fr, fr, 11, 100, 0, 0, 0.03, 0),
 ac_proc_err = calc_DO_mod_with_error(
  10, -13, 2.5, 14, 1, rep(12,100), fr, fr, fr, 11, 100, 0, 0, 0.03, 0.6),
 all_err = calc_DO_mod_with_error(
  10, -13, 2.5, 14, 1, rep(12,100), fr, fr, fr, 11, 100, 0.1, 0.6, 0.03, 0.6)
)
all(preds$no_err == calc_DO_mod(10, -13, 2.5, 14, 1, rep(12,100),
  rep(1/100,100), rep(1/100,100), rep(1/100,100), 11, 100))
library(ggplot2); library(tidyr)
ggplot(gather(preds, type, value, no_err, obs_err, ac_obs_err),
  aes(x=t, y=value, color=type)) + geom_line()
ggplot(gather(preds, type, value, no_err, proc_err, ac_proc_err),
  aes(x=t, y=value, color=type)) + geom_line()
ggplot(gather(preds, type, value, no_err, all_err),
  aes(x=t, y=value, color=type)) + geom_line()
}


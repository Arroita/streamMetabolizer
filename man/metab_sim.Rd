% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/metab_sim.R
\name{metab_sim}
\alias{metab_sim}
\title{Simulate dissolved oxygen data from input data}
\usage{
metab_sim(specs = specs(mm_name("sim")), data = mm_data(solar.time, DO.obs,
  DO.sat, depth, temp.water, light, optional = "DO.obs"),
  data_daily = mm_data(date, DO.mod.1, GPP, ER, K600, optional = "DO.mod.1"),
  info = NULL)
}
\arguments{
\item{specs}{a list of model specifications and parameters for a model. 
Although this may be specified manually (it's just a list), it is easier
and safer to use \code{\link{specs}} to generate the list, because the set
of required parameters and their defaults depends on the model given in the
\code{model_name} argument to \code{specs}. The help file for 
\code{\link{specs}} lists the necessary parameters, describes them in 
detail, and gives default values.}

\item{data}{data.frame of input data at the temporal resolution of raw 
observations (unit-value). Columns must have the same names, units, and 
format as the default. See the \strong{'Formatting \code{data}'} section 
below for a full description.}

\item{data_daily}{data.frame containing inputs with a daily timestep. See the
\strong{'Formatting \code{data_daily}'} section below for a full 
description.}

\item{info}{any information, in any format, that you would like to store 
within the metab_model object}
}
\value{
A metab_sim object containing the fitted model. This object can be 
  inspected with the functions in the \code{\link{metab_model_interface}}.
}
\description{
Takes input data in the form of a sub-daily time series (\code{data}) of 
DO.sat, depth, temperature, and light, and a daily time series 
(\code{data_daily}) of GPP, ER, and K600 values, and turns these into 
simulated DO.obs. Either \code{data} or \code{data_daily} should specify a 
starting DO.obs value for each day; if in \code{data}, this takes the form of
a DO.obs column with values on at least the first time point of each day (all
other values are ignored), or if in \code{data_daily}, this takes the form of
a DO.mod.1 column with one starting DO value per day.
}
\examples{
# set the date in several formats
start.chron <- chron::chron(dates="08/23/12", times="22:00:00")
end.chron <- chron::chron(dates="08/25/12", times="06:00:00")
start.posix <- as.POSIXct(format(start.chron, "\%Y-\%m-\%d \%H:\%M:\%S"), tz="UTC")
end.posix <- as.POSIXct(format(end.chron, "\%Y-\%m-\%d \%H:\%M:\%S"), tz="UTC")
mid.date <- as.Date(start.posix + (end.posix - start.posix)/2, tz=lubridate::tz(start.posix))
start.numeric <- as.numeric(start.posix - as.POSIXct(format(mid.date, "\%Y-\%m-\%d 00:00:00"),
   tz="UTC"), units='hours')
end.numeric <- as.numeric(end.posix - as.POSIXct(format(mid.date, "\%Y-\%m-\%d 00:00:00"),
  tz="UTC"), units='hours')

# get, format, & subset data
vfrench <- streamMetabolizer:::load_french_creek(attach.units=FALSE)
vfrenchshort <- vfrench[vfrench$solar.time >= start.posix & vfrench$solar.time <= end.posix, ]
vdaily <- data.frame(date="2012-08-24", GPP=2, ER=-3, K600=21, stringsAsFactors=FALSE)

# sim
mm <- metab_sim(specs=specs('s_np_oipcpi_eu_.rnorm', err.proc.sigma=0.07, 
  day_start=start.numeric, day_end=end.numeric), data=vfrenchshort, data_daily=vdaily)
get_fit(mm)
get_data_daily(mm)
get_fitting_time(mm)
plot_DO_preds(predict_DO(mm))
plot_DO_preds(predict_DO(mm))
\dontrun{
 metab_sim(data=data.frame(empty="shouldbreak"))
}
}
\author{
Alison Appling, Bob Hall
}
\seealso{
Other metab_model: \code{\link{metab_Kmodel}},
  \code{\link{metab_bayes}}, \code{\link{metab_mle}},
  \code{\link{metab_night}}
}

